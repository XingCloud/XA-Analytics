(function(){function Z(b,n,m){if(b===n){return b!==0||1/b==1/n}if(b==null||n==null){return b===n}if(b._chain){b=b._wrapped}if(n._chain){n=n._wrapped}if(b.isEqual&&aj.isFunction(b.isEqual)){return b.isEqual(n)}if(n.isEqual&&aj.isFunction(n.isEqual)){return n.isEqual(b)}var l=af.call(b);if(l!=af.call(n)){return false}switch(l){case"[object String]":return b==String(n);case"[object Number]":return b!=+b?n!=+n:b==0?1/b==1/n:b==+n;case"[object Date]":case"[object Boolean]":return +b==+n;case"[object RegExp]":return b.source==n.source&&b.global==n.global&&b.multiline==n.multiline&&b.ignoreCase==n.ignoreCase}if(typeof b!="object"||typeof n!="object"){return false}for(var k=m.length;k--;){if(m[k]==b){return true}}m.push(b);var k=0,j=true;if(l=="[object Array]"){if(k=b.length,j=k==n.length){for(;k--;){if(!(j=k in b==k in n&&Z(b[k],n[k],m))){break}}}}else{if("constructor" in b!="constructor" in n||b.constructor!=n.constructor){return false}for(var i in b){if(aj.has(b,i)&&(k++,!(j=aj.has(n,i)&&Z(b[i],n[i],m)))){break}}if(j){for(i in n){if(aj.has(n,i)&&!k--){break}}j=!k}}m.pop();return j}var X=this,P=X._,ad={},ag=Array.prototype,ac=Object.prototype,ai=ag.slice,M=ag.unshift,af=ac.toString,g=ac.hasOwnProperty,N=ag.forEach,h=ag.map,f=ag.reduce,d=ag.reduceRight,ab=ag.filter,Y=ag.every,W=ag.some,aa=ag.indexOf,V=ag.lastIndexOf,ac=Array.isArray,e=Object.keys,U=Function.prototype.bind,aj=function(b){return new ae(b)};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=aj}exports._=aj}else{X._=aj}aj.VERSION="1.3.1";var ah=aj.each=aj.forEach=function(b,l,k){if(b!=null){if(N&&b.forEach===N){b.forEach(l,k)}else{if(b.length===+b.length){for(var j=0,i=b.length;j<i;j++){if(j in b&&l.call(k,b[j],j,b)===ad){break}}}else{for(j in b){if(aj.has(b,j)&&l.call(k,b[j],j,b)===ad){break}}}}}};aj.map=aj.collect=function(j,l,i){var k=[];if(j==null){return k}if(h&&j.map===h){return j.map(l,i)}ah(j,function(b,n,m){k[k.length]=l.call(i,b,n,m)});if(j.length===+j.length){k.length=j.length}return k};aj.reduce=aj.foldl=aj.inject=function(b,l,k,j){var i=arguments.length>2;b==null&&(b=[]);if(f&&b.reduce===f){return j&&(l=aj.bind(l,j)),i?b.reduce(l,k):b.reduce(l)}ah(b,function(n,m,o){i?k=l.call(j,k,n,m,o):(k=n,i=true)});if(!i){throw new TypeError("Reduce of empty array with no initial value")}return k};aj.reduceRight=aj.foldr=function(b,m,l,k){var j=arguments.length>2;b==null&&(b=[]);if(d&&b.reduceRight===d){return k&&(m=aj.bind(m,k)),j?b.reduceRight(m,l):b.reduceRight(m)}var i=aj.toArray(b).reverse();k&&!j&&(m=aj.bind(m,k));return j?aj.reduce(i,m,l,k):aj.reduce(i,m)};aj.find=aj.detect=function(j,l,i){var k;T(j,function(b,n,m){if(l.call(i,b,n,m)){return k=b,true}});return k};aj.filter=aj.select=function(j,l,i){var k=[];if(j==null){return k}if(ab&&j.filter===ab){return j.filter(l,i)}ah(j,function(b,n,m){l.call(i,b,n,m)&&(k[k.length]=b)});return k};aj.reject=function(j,l,i){var k=[];if(j==null){return k}ah(j,function(b,n,m){l.call(i,b,n,m)||(k[k.length]=b)});return k};aj.every=aj.all=function(j,l,i){var k=true;if(j==null){return k}if(Y&&j.every===Y){return j.every(l,i)}ah(j,function(b,n,m){if(!(k=k&&l.call(i,b,n,m))){return ad}});return k};var T=aj.some=aj.any=function(b,k,j){k||(k=aj.identity);var i=false;if(b==null){return i}if(W&&b.some===W){return b.some(k,j)}ah(b,function(m,l,n){if(i||(i=k.call(j,m,l,n))){return ad}});return !!i};aj.include=aj.contains=function(j,k){var i=false;if(j==null){return i}return aa&&j.indexOf===aa?j.indexOf(k)!=-1:i=T(j,function(b){return b===k})};aj.invoke=function(b,j){var i=ai.call(arguments,2);return aj.map(b,function(k){return(aj.isFunction(j)?j||k:k[j]).apply(k,i)})};aj.pluck=function(b,i){return aj.map(b,function(j){return j[i]})};aj.max=function(b,k,j){if(!k&&aj.isArray(b)){return Math.max.apply(Math,b)}if(!k&&aj.isEmpty(b)){return -Infinity}var i={computed:-Infinity};ah(b,function(m,l,n){l=k?k.call(j,m,l,n):m;l>=i.computed&&(i={value:m,computed:l})});return i.value};aj.min=function(b,k,j){if(!k&&aj.isArray(b)){return Math.min.apply(Math,b)}if(!k&&aj.isEmpty(b)){return Infinity}var i={computed:Infinity};ah(b,function(m,l,n){l=k?k.call(j,m,l,n):m;l<i.computed&&(i={value:m,computed:l})});return i.value};aj.shuffle=function(j){var i=[],k;ah(j,function(b,l){l==0?i[0]=b:(k=Math.floor(Math.random()*(l+1)),i[l]=i[k],i[k]=b)});return i};aj.sortBy=function(b,j,i){return aj.pluck(aj.map(b,function(l,k,m){return{value:l,criteria:j.call(i,l,k,m)}}).sort(function(l,k){var n=l.criteria,m=k.criteria;return n<m?-1:n>m?1:0}),"value")};aj.groupBy=function(b,k){var j={},i=aj.isFunction(k)?k:function(l){return l[k]};ah(b,function(m,l){var n=i(m,l);(j[n]||(j[n]=[])).push(m)});return j};aj.sortedIndex=function(b,m,l){l||(l=aj.identity);for(var k=0,j=b.length;k<j;){var i=k+j>>1;l(b[i])<l(m)?k=i+1:j=i}return k};aj.toArray=function(b){return !b?[]:b.toArray?b.toArray():aj.isArray(b)?ai.call(b):aj.isArguments(b)?ai.call(b):aj.values(b)};aj.size=function(b){return aj.toArray(b).length};aj.first=aj.head=function(j,i,k){return i!=null&&!k?ai.call(j,0,i):j[0]};aj.initial=function(j,i,k){return ai.call(j,0,j.length-(i==null||k?1:i))};aj.last=function(j,i,k){return i!=null&&!k?ai.call(j,Math.max(j.length-i,0)):j[j.length-1]};aj.rest=aj.tail=function(j,i,k){return ai.call(j,i==null||k?1:i)};aj.compact=function(b){return aj.filter(b,function(i){return !!i})};aj.flatten=function(b,i){return aj.reduce(b,function(j,k){if(aj.isArray(k)){return j.concat(i?k:aj.flatten(k))}j[j.length]=k;return j},[])};aj.without=function(b){return aj.difference(b,ai.call(arguments,1))};aj.uniq=aj.unique=function(b,k,j){var j=j?aj.map(b,j):b,i=[];aj.reduce(j,function(n,m,l){if(0==l||(k===true?aj.last(n)!=m:!aj.include(n,m))){n[n.length]=m,i[i.length]=b[l]}return n},[]);return i};aj.union=function(){return aj.uniq(aj.flatten(arguments,true))};aj.intersection=aj.intersect=function(b){var i=ai.call(arguments,1);return aj.filter(aj.uniq(b),function(j){return aj.every(i,function(k){return aj.indexOf(k,j)>=0})})};aj.difference=function(b){var i=aj.flatten(ai.call(arguments,1));return aj.filter(b,function(j){return !aj.include(i,j)})};aj.zip=function(){for(var b=ai.call(arguments),k=aj.max(aj.pluck(b,"length")),j=Array(k),i=0;i<k;i++){j[i]=aj.pluck(b,""+i)}return j};aj.indexOf=function(b,k,j){if(b==null){return -1}var i;if(j){return j=aj.sortedIndex(b,k),b[j]===k?j:-1}if(aa&&b.indexOf===aa){return b.indexOf(k)}for(j=0,i=b.length;j<i;j++){if(j in b&&b[j]===k){return j}}return -1};aj.lastIndexOf=function(j,i){if(j==null){return -1}if(V&&j.lastIndexOf===V){return j.lastIndexOf(i)}for(var k=j.length;k--;){if(k in j&&j[k]===i){return k}}return -1};aj.range=function(j,i,n){arguments.length<=1&&(i=j||0,j=0);for(var n=arguments[2]||1,m=Math.max(Math.ceil((i-j)/n),0),l=0,k=Array(m);l<m;){k[l++]=j,j+=n}return k};var R=function(){};aj.bind=function(b,k){var j,i;if(b.bind===U&&U){return U.apply(b,ai.call(arguments,1))}if(!aj.isFunction(b)){throw new TypeError}i=ai.call(arguments,2);return j=function(){if(!(this instanceof j)){return b.apply(k,i.concat(ai.call(arguments)))}R.prototype=b.prototype;var l=new R,m=b.apply(l,i.concat(ai.call(arguments)));return Object(m)===m?m:l}};aj.bindAll=function(b){var i=ai.call(arguments,1);i.length==0&&(i=aj.functions(b));ah(i,function(j){b[j]=aj.bind(b[j],b)});return b};aj.memoize=function(b,j){var i={};j||(j=aj.identity);return function(){var k=j.apply(this,arguments);return aj.has(i,k)?i[k]:i[k]=b.apply(this,arguments)}};aj.delay=function(j,i){var k=ai.call(arguments,2);return setTimeout(function(){return j.apply(j,k)},i)};aj.defer=function(b){return aj.delay.apply(aj,[b,1].concat(ai.call(arguments,1)))};aj.throttle=function(b,p){var o,n,m,l,k,j=aj.debounce(function(){k=l=false},p);return function(){o=this;n=arguments;var i;m||(m=setTimeout(function(){m=null;k&&b.apply(o,n);j()},p));l?k=true:b.apply(o,n);j();l=true}};aj.debounce=function(j,i){var k;return function(){var l=this,b=arguments;clearTimeout(k);k=setTimeout(function(){k=null;j.apply(l,b)},i)}};aj.once=function(j){var i=false,k;return function(){if(i){return k}i=true;return k=j.apply(this,arguments)}};aj.wrap=function(j,i){return function(){var b=[j].concat(ai.call(arguments,0));return i.apply(this,b)}};aj.compose=function(){var b=arguments;return function(){for(var i=arguments,j=b.length-1;j>=0;j--){i=[b[j].apply(this,i)]}return i[0]}};aj.after=function(j,i){return j<=0?i():function(){if(--j<1){return i.apply(this,arguments)}}};aj.keys=e||function(b){if(b!==Object(b)){throw new TypeError("Invalid object")}var j=[],i;for(i in b){aj.has(b,i)&&(j[j.length]=i)}return j};aj.values=function(b){return aj.map(b,aj.identity)};aj.functions=aj.methods=function(b){var j=[],i;for(i in b){aj.isFunction(b[i])&&j.push(i)}return j.sort()};aj.extend=function(b){ah(ai.call(arguments,1),function(i){for(var j in i){b[j]=i[j]}});return b};aj.defaults=function(b){ah(ai.call(arguments,1),function(i){for(var j in i){b[j]==null&&(b[j]=i[j])}});return b};aj.clone=function(b){return !aj.isObject(b)?b:aj.isArray(b)?b.slice():aj.extend({},b)};aj.tap=function(j,i){i(j);return j};aj.isEqual=function(j,i){return Z(j,i,[])};aj.isEmpty=function(b){if(aj.isArray(b)||aj.isString(b)){return b.length===0}for(var i in b){if(aj.has(b,i)){return false}}return true};aj.isElement=function(b){return !!(b&&b.nodeType==1)};aj.isArray=ac||function(b){return af.call(b)=="[object Array]"};aj.isObject=function(b){return b===Object(b)};aj.isArguments=function(b){return af.call(b)=="[object Arguments]"};if(!aj.isArguments(arguments)){aj.isArguments=function(b){return !(!b||!aj.has(b,"callee"))}}aj.isFunction=function(b){return af.call(b)=="[object Function]"};aj.isString=function(b){return af.call(b)=="[object String]"};aj.isNumber=function(b){return af.call(b)=="[object Number]"};aj.isNaN=function(b){return b!==b};aj.isBoolean=function(b){return b===true||b===false||af.call(b)=="[object Boolean]"};aj.isDate=function(b){return af.call(b)=="[object Date]"};aj.isRegExp=function(b){return af.call(b)=="[object RegExp]"};aj.isNull=function(b){return b===null};aj.isUndefined=function(b){return b===void 0};aj.has=function(j,i){return g.call(j,i)};aj.noConflict=function(){X._=P;return this};aj.identity=function(b){return b};aj.times=function(j,i,l){for(var k=0;k<j;k++){i.call(l,k)}};aj.escape=function(b){return(""+b).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};aj.mixin=function(b){ah(aj.functions(b),function(i){c(i,aj[i]=b[i])})};var a=0;aj.uniqueId=function(j){var i=a++;return j?j+i:i};aj.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var S=/.^/,Q=function(b){return b.replace(/\\\\/g,"\\").replace(/\\'/g,"'")};aj.template=function(b,k){var j=aj.templateSettings,j="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+b.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(j.escape||S,function(m,l){return"',_.escape("+Q(l)+"),'"}).replace(j.interpolate||S,function(m,l){return"',"+Q(l)+",'"}).replace(j.evaluate||S,function(m,l){return"');"+Q(l).replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",i=new Function("obj","_",j);return k?i(k,aj):function(l){return i.call(this,l,aj)}};aj.chain=function(b){return aj(b).chain()};var ae=function(b){this._wrapped=b};aj.prototype=ae.prototype;var O=function(b,i){return i?aj(b).chain():b},c=function(b,i){ae.prototype[b]=function(){var j=ai.call(arguments);M.call(j,this._wrapped);return O(i.apply(aj,j),this._chain)}};aj.mixin(aj);ah("pop,push,reverse,shift,sort,splice,unshift".split(","),function(j){var i=ag[j];ae.prototype[j]=function(){var k=this._wrapped;i.apply(k,arguments);var b=k.length;(j=="shift"||j=="splice")&&b===0&&delete k[0];return O(k,this._chain)}});ah(["concat","join","slice"],function(j){var i=ag[j];ae.prototype[j]=function(){return O(i.apply(this._wrapped,arguments),this._chain)}});ae.prototype.chain=function(){this._chain=true;return this};ae.prototype.value=function(){return this._wrapped}}).call(this);(function(){var n=this;var l=n.Backbone;var m=Array.prototype.slice;var u=Array.prototype.splice;var b;if(typeof exports!=="undefined"){b=exports}else{b=n.Backbone={}}b.VERSION="0.9.1";var v=n._;if(!v&&(typeof require!=="undefined")){v=require("underscore")}var e=n.jQuery||n.Zepto||n.ender;b.setDomLibrary=function(w){e=w};b.noConflict=function(){n.Backbone=l;return this};b.emulateHTTP=false;b.emulateJSON=false;b.Events={on:function(z,C,y){var A;z=z.split(/\s+/);var x=this._callbacks||(this._callbacks={});while(A=z.shift()){var B=x[A]||(x[A]={});var w=B.tail||(B.tail=B.next={});w.callback=C;w.context=y;B.tail=w.next={}}return this},off:function(y,B,x){var A,w,z;if(!y){delete this._callbacks}else{if(w=this._callbacks){y=y.split(/\s+/);while(A=y.shift()){z=w[A];delete w[A];if(!B||!z){continue}while((z=z.next)&&z.next){if(z.callback===B&&(!x||z.context===x)){continue}this.on(A,z.callback,z.context)}}}}return this},trigger:function(z){var D,C,y,x,w,B,A;if(!(y=this._callbacks)){return this}B=y.all;(z=z.split(/\s+/)).push(null);while(D=z.shift()){if(B){z.push({next:B.next,tail:B.tail,event:D})}if(!(C=y[D])){continue}z.push({next:C.next,tail:C.tail})}A=m.call(arguments,1);while(C=z.pop()){x=C.tail;w=C.event?[C.event].concat(A):A;while((C=C.next)!==x){C.callback.apply(C.context||this,w)}}return this}};b.Events.bind=b.Events.on;b.Events.unbind=b.Events.off;b.Model=function(w,x){var y;w||(w={});if(x&&x.parse){w=this.parse(w)}if(y=c(this,"defaults")){w=v.extend({},y,w)}if(x&&x.collection){this.collection=x.collection}this.attributes={};this._escapedAttributes={};this.cid=v.uniqueId("c");if(!this.set(w,{silent:true})){throw new Error("Can't create an invalid model")}delete this._changed;this._previousAttributes=v.clone(this.attributes);this.initialize.apply(this,arguments)};v.extend(b.Model.prototype,b.Events,{idAttribute:"id",initialize:function(){},toJSON:function(){return v.clone(this.attributes)},get:function(w){return this.attributes[w]},escape:function(w){var x;if(x=this._escapedAttributes[w]){return x}var y=this.attributes[w];return this._escapedAttributes[w]=v.escape(y==null?"":""+y)},has:function(w){return this.attributes[w]!=null},set:function(D,C,F){var E,B,y;if(v.isObject(D)||D==null){E=D;F=C}else{E={};E[D]=C}F||(F={});if(!E){return this}if(E instanceof b.Model){E=E.attributes}if(F.unset){for(B in E){E[B]=void 0}}if(!this._validate(E,F)){return false}if(this.idAttribute in E){this.id=E[this.idAttribute]}var x=this.attributes;var w=this._escapedAttributes;var z=this._previousAttributes||{};var A=this._setting;this._changed||(this._changed={});this._setting=true;for(B in E){y=E[B];if(!v.isEqual(x[B],y)){delete w[B]}F.unset?delete x[B]:x[B]=y;if(this._changing&&!v.isEqual(this._changed[B],y)){this.trigger("change:"+B,this,y,F);this._moreChanges=true}delete this._changed[B];if(!v.isEqual(z[B],y)||(v.has(x,B)!=v.has(z,B))){this._changed[B]=y}}if(!A){if(!F.silent&&this.hasChanged()){this.change(F)}this._setting=false}return this},unset:function(w,x){(x||(x={})).unset=true;return this.set(w,null,x)},clear:function(w){(w||(w={})).unset=true;return this.set(v.clone(this.attributes),w)},fetch:function(x){x=x?v.clone(x):{};var w=this;var y=x.success;x.success=function(B,z,A){if(!w.set(w.parse(B,A),x)){return false}if(y){y(w,B)}};x.error=b.wrapError(x.error,w,x);return(this.sync||b.sync).call(this,"read",this,x)},save:function(B,A,F){var C,z;if(v.isObject(B)||B==null){C=B;F=A}else{C={};C[B]=A}F=F?v.clone(F):{};if(F.wait){z=v.clone(this.attributes)}var x=v.extend({},F,{silent:true});if(C&&!this.set(C,F.wait?x:F)){return false}var y=this;var D=F.success;F.success=function(J,G,I){var H=y.parse(J,I);if(F.wait){H=v.extend(C||{},H)}if(!y.set(H,F)){return false}if(D){D(y,J)}else{y.trigger("sync",y,J,F)}};F.error=b.wrapError(F.error,y,F);var w=this.isNew()?"create":"update";var E=(this.sync||b.sync).call(this,w,this,F);if(F.wait){this.set(z,x)}return E},destroy:function(x){x=x?v.clone(x):{};var w=this;var A=x.success;var z=function(){w.trigger("destroy",w,w.collection,x)};if(this.isNew()){return z()}x.success=function(B){if(x.wait){z()}if(A){A(w,B)}else{w.trigger("sync",w,B,x)}};x.error=b.wrapError(x.error,w,x);var y=(this.sync||b.sync).call(this,"delete",this,x);if(!x.wait){z()}return y},url:function(){var w=c(this.collection,"url")||c(this,"urlRoot")||p();if(this.isNew()){return w}return w+(w.charAt(w.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(x,w){return x},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},change:function(x){if(this._changing||!this.hasChanged()){return this}this._changing=true;this._moreChanges=true;for(var w in this._changed){this.trigger("change:"+w,this,this._changed[w],x)}while(this._moreChanges){this._moreChanges=false;this.trigger("change",this,x)}this._previousAttributes=v.clone(this.attributes);delete this._changed;this._changing=false;return this},hasChanged:function(w){if(!arguments.length){return !v.isEmpty(this._changed)}return this._changed&&v.has(this._changed,w)},changedAttributes:function(y){if(!y){return this.hasChanged()?v.clone(this._changed):false}var A,z=false,x=this._previousAttributes;for(var w in y){if(v.isEqual(x[w],(A=y[w]))){continue}(z||(z={}))[w]=A}return z},previous:function(w){if(!arguments.length||!this._previousAttributes){return null}return this._previousAttributes[w]},previousAttributes:function(){return v.clone(this._previousAttributes)},isValid:function(){return !this.validate(this.attributes)},_validate:function(y,x){if(x.silent||!this.validate){return true}y=v.extend({},this.attributes,y);var w=this.validate(y,x);if(!w){return true}if(x&&x.error){x.error(this,w,x)}else{this.trigger("error",this,w,x)}return false}});b.Collection=function(x,w){w||(w={});if(w.comparator){this.comparator=w.comparator}this._reset();this.initialize.apply(this,arguments);if(x){this.reset(x,{silent:true,parse:w.parse})}};v.extend(b.Collection.prototype,b.Events,{model:b.Model,initialize:function(){},toJSON:function(){return this.map(function(w){return w.toJSON()})},add:function(x,F){var B,D,z,C,E,y,A={},w={};F||(F={});x=v.isArray(x)?x.slice():[x];for(B=0,z=x.length;B<z;B++){if(!(C=x[B]=this._prepareModel(x[B],F))){throw new Error("Can't add an invalid model to a collection")}if(A[E=C.cid]||this._byCid[E]||(((y=C.id)!=null)&&(w[y]||this._byId[y]))){throw new Error("Can't add the same model to a collection twice")}A[E]=w[y]=C}for(B=0;B<z;B++){(C=x[B]).on("all",this._onModelEvent,this);this._byCid[C.cid]=C;if(C.id!=null){this._byId[C.id]=C}}this.length+=z;D=F.at!=null?F.at:this.models.length;u.apply(this.models,[D,0].concat(x));if(this.comparator){this.sort({silent:true})}if(F.silent){return this}for(B=0,z=this.models.length;B<z;B++){if(!A[(C=this.models[B]).cid]){continue}F.index=B;C.trigger("add",C,this,F)}return this},remove:function(B,z){var A,w,y,x;z||(z={});B=v.isArray(B)?B.slice():[B];for(A=0,w=B.length;A<w;A++){x=this.getByCid(B[A])||this.get(B[A]);if(!x){continue}delete this._byId[x.id];delete this._byCid[x.cid];y=this.indexOf(x);this.models.splice(y,1);this.length--;if(!z.silent){z.index=y;x.trigger("remove",x,this,z)}this._removeReference(x)}return this},get:function(w){if(w==null){return null}return this._byId[w.id!=null?w.id:w]},getByCid:function(w){return w&&this._byCid[w.cid||w]},at:function(w){return this.models[w]},sort:function(x){x||(x={});if(!this.comparator){throw new Error("Cannot sort a set without a comparator")}var w=v.bind(this.comparator,this);if(this.comparator.length==1){this.models=this.sortBy(w)}else{this.models.sort(w)}if(!x.silent){this.trigger("reset",this,x)}return this},pluck:function(w){return v.map(this.models,function(x){return x.get(w)})},reset:function(z,x){z||(z=[]);x||(x={});for(var y=0,w=this.models.length;y<w;y++){this._removeReference(this.models[y])}this._reset();this.add(z,{silent:true,parse:x.parse});if(!x.silent){this.trigger("reset",this,x)}return this},fetch:function(w){w=w?v.clone(w):{};if(w.parse===undefined){w.parse=true}var y=this;var x=w.success;w.success=function(B,z,A){y[w.add?"add":"reset"](y.parse(B,A),w);if(x){x(y,B)}};w.error=b.wrapError(w.error,y,w);return(this.sync||b.sync).call(this,"read",this,w)},create:function(x,w){var y=this;w=w?v.clone(w):{};x=this._prepareModel(x,w);if(!x){return false}if(!w.wait){y.add(x,w)}var z=w.success;w.success=function(A,C,B){if(w.wait){y.add(A,w)}if(z){z(A,C)}else{A.trigger("sync",x,C,w)}};x.save(null,w);return x},parse:function(x,w){return x},chain:function(){return v(this.models).chain()},_reset:function(w){this.length=0;this.models=[];this._byId={};this._byCid={}},_prepareModel:function(y,x){if(!(y instanceof b.Model)){var w=y;x.collection=this;y=new this.model(w,x);if(!y._validate(y.attributes,x)){y=false}}else{if(!y.collection){y.collection=this}}return y},_removeReference:function(w){if(this==w.collection){delete w.collection}w.off("all",this._onModelEvent,this)},_onModelEvent:function(y,x,z,w){if((y=="add"||y=="remove")&&z!=this){return}if(y=="destroy"){this.remove(x,w)}if(x&&y==="change:"+x.idAttribute){delete this._byId[x.previous(x.idAttribute)];this._byId[x.id]=x}this.trigger.apply(this,arguments)}});var s=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","initial","rest","last","without","indexOf","shuffle","lastIndexOf","isEmpty","groupBy"];v.each(s,function(w){b.Collection.prototype[w]=function(){return v[w].apply(v,[this.models].concat(v.toArray(arguments)))}});b.Router=function(w){w||(w={});if(w.routes){this.routes=w.routes}this._bindRoutes();this.initialize.apply(this,arguments)};var g=/:\w+/g;var t=/\*\w+/g;var d=/[-[\]{}()+?.,\\^$|#\s]/g;v.extend(b.Router.prototype,b.Events,{initialize:function(){},route:function(w,x,y){b.history||(b.history=new b.History);if(!v.isRegExp(w)){w=this._routeToRegExp(w)}if(!y){y=this[x]}b.history.route(w,v.bind(function(A){var z=this._extractParameters(w,A);y&&y.apply(this,z);this.trigger.apply(this,["route:"+x].concat(z));b.history.trigger("route",this,x,z)},this));return this},navigate:function(x,w){b.history.navigate(x,w)},_bindRoutes:function(){if(!this.routes){return}var x=[];for(var y in this.routes){x.unshift([y,this.routes[y]])}for(var z=0,w=x.length;z<w;z++){this.route(x[z][0],x[z][1],this[x[z][1]])}},_routeToRegExp:function(w){w=w.replace(d,"\\$&").replace(g,"([^/]+)").replace(t,"(.*?)");return new RegExp("^"+w+"$")},_extractParameters:function(w,x){return w.exec(x).slice(1)}});b.History=function(){this.handlers=[];v.bindAll(this,"checkUrl")};var k=/^[#\/]/;var h=/msie [\w.]+/;var j=false;v.extend(b.History.prototype,b.Events,{interval:50,getFragment:function(x,w){if(x==null){if(this._hasPushState||w){x=window.location.pathname;var y=window.location.search;if(y){x+=y}}else{x=window.location.hash}}x=decodeURIComponent(x);if(!x.indexOf(this.options.root)){x=x.substr(this.options.root.length)}return x.replace(k,"")},start:function(y){if(j){throw new Error("Backbone.history has already been started")}this.options=v.extend({},{root:"/"},this.options,y);this._wantsHashChange=this.options.hashChange!==false;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var x=this.getFragment();var w=document.documentMode;var A=(h.exec(navigator.userAgent.toLowerCase())&&(!w||w<=7));if(A){this.iframe=e('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;this.navigate(x)}if(this._hasPushState){e(window).bind("popstate",this.checkUrl)}else{if(this._wantsHashChange&&("onhashchange" in window)&&!A){e(window).bind("hashchange",this.checkUrl)}else{if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval)}}}this.fragment=x;j=true;var B=window.location;var z=B.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!z){this.fragment=this.getFragment(null,true);window.location.replace(this.options.root+"#"+this.fragment);return true}else{if(this._wantsPushState&&this._hasPushState&&z&&B.hash){this.fragment=B.hash.replace(k,"");window.history.replaceState({},document.title,B.protocol+"//"+B.host+this.options.root+this.fragment)}}if(!this.options.silent){return this.loadUrl()}},stop:function(){e(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);j=false},route:function(w,x){this.handlers.unshift({route:w,callback:x})},checkUrl:function(x){var w=this.getFragment();if(w==this.fragment&&this.iframe){w=this.getFragment(this.iframe.location.hash)}if(w==this.fragment||w==decodeURIComponent(this.fragment)){return false}if(this.iframe){this.navigate(w)}this.loadUrl()||this.loadUrl(window.location.hash)},loadUrl:function(y){var x=this.fragment=this.getFragment(y);var w=v.any(this.handlers,function(z){if(z.route.test(x)){z.callback(x);return true}});return w},navigate:function(x,w){if(!j){return false}if(!w||w===true){w={trigger:w}}var y=(x||"").replace(k,"");if(this.fragment==y||this.fragment==decodeURIComponent(y)){return}if(this._hasPushState){if(y.indexOf(this.options.root)!=0){y=this.options.root+y}this.fragment=y;window.history[w.replace?"replaceState":"pushState"]({},document.title,y)}else{if(this._wantsHashChange){this.fragment=y;this._updateHash(window.location,y,w.replace);if(this.iframe&&(y!=this.getFragment(this.iframe.location.hash))){if(!w.replace){this.iframe.document.open().close()}this._updateHash(this.iframe.location,y,w.replace)}}else{window.location.assign(this.options.root+x)}}if(w.trigger){this.loadUrl(x)}},_updateHash:function(w,x,y){if(y){w.replace(w.toString().replace(/(javascript:|#).*$/,"")+"#"+x)}else{w.hash=x}}});b.View=function(w){this.cid=v.uniqueId("view");this._configure(w||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var a=/^(\S+)\s*(.*)$/;var q=["model","collection","el","id","attributes","className","tagName"];v.extend(b.View.prototype,b.Events,{tagName:"div",$:function(w){return this.$el.find(w)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();return this},make:function(x,w,z){var y=document.createElement(x);if(w){e(y).attr(w)}if(z){e(y).html(z)}return y},setElement:function(w,x){this.$el=e(w);this.el=this.$el[0];if(x!==false){this.delegateEvents()}return this},delegateEvents:function(A){if(!(A||(A=c(this,"events")))){return}this.undelegateEvents();for(var z in A){var B=A[z];if(!v.isFunction(B)){B=this[A[z]]}if(!B){throw new Error('Event "'+A[z]+'" does not exist')}var y=z.match(a);var x=y[1],w=y[2];B=v.bind(B,this);x+=".delegateEvents"+this.cid;if(w===""){this.$el.bind(x,B)}else{this.$el.delegate(w,x,B)}}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(y){if(this.options){y=v.extend({},this.options,y)}for(var z=0,x=q.length;z<x;z++){var w=q[z];if(y[w]){this[w]=y[w]}}this.options=y},_ensureElement:function(){if(!this.el){var w=c(this,"attributes")||{};if(this.id){w.id=this.id}if(this.className){w["class"]=this.className}this.setElement(this.make(this.tagName,w),false)}else{this.setElement(this.el,false)}}});var r=function(w,x){var y=i(this,w,x);y.extend=this.extend;return y};b.Model.extend=b.Collection.extend=b.Router.extend=b.View.extend=r;var o={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};b.sync=function(A,x,w){var y=o[A];var z={type:y,dataType:"json"};if(!w.url){z.url=c(x,"url")||p()}if(!w.data&&x&&(A=="create"||A=="update")){z.contentType="application/json";z.data=JSON.stringify(x.toJSON())}if(b.emulateJSON){z.contentType="application/x-www-form-urlencoded";z.data=z.data?{model:z.data}:{}}if(b.emulateHTTP){if(y==="PUT"||y==="DELETE"){if(b.emulateJSON){z.data._method=y}z.type="POST";z.beforeSend=function(B){B.setRequestHeader("X-HTTP-Method-Override",y)}}}if(z.type!=="GET"&&!b.emulateJSON){z.processData=false}return e.ajax(v.extend(z,w))};b.wrapError=function(x,y,w){return function(z,A){A=z===y?A:z;if(x){x(y,A,w)}else{y.trigger("error",y,A,w)}}};var f=function(){};var i=function(x,w,y){var z;if(w&&w.hasOwnProperty("constructor")){z=w.constructor}else{z=function(){x.apply(this,arguments)}}v.extend(z,x);f.prototype=x.prototype;z.prototype=new f();if(w){v.extend(z.prototype,w)}if(y){v.extend(z,y)}z.prototype.constructor=z;z.__super__=x.prototype;return z};var c=function(w,x){if(!(w&&w[x])){return null}return v.isFunction(w[x])?w[x]():w[x]};var p=function(){throw new Error('A "url" property or function must be specified')}}).call(this);var Haml;(function(){var matchers,self_close_tags,embedder,forceXML,escaperName,escapeHtmlByDefault;function html_escape(text){return(text+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;")}function render_attribs(attribs){var key,value,result=[];for(key in attribs){if(key!=="_content"&&attribs.hasOwnProperty(key)){switch(attribs[key]){case"undefined":case"false":case"null":case'""':break;default:try{value=JSON.parse("["+attribs[key]+"]")[0];if(value===true){value=key}else{if(typeof value==="string"&&embedder.test(value)){value='" +\n'+parse_interpol(html_escape(value))+' +\n"'}else{value=html_escape(value)}}result.push(" "+key+'=\\"'+value+'\\"')}catch(e){result.push(" "+key+'=\\"" + '+escaperName+"("+attribs[key]+') + "\\"')}}}}return result.join("")}function parse_attribs(line){var attributes={},l=line.length,i,c,count=1,quote=false,skip=false,open,close,joiner,seperator,pair={start:1,middle:null,end:null};if(!(l>0&&(line.charAt(0)==="{"||line.charAt(0)==="("))){return{_content:line[0]===" "?line.substr(1,l):line}}open=line.charAt(0);close=(open==="{")?"}":")";joiner=(open==="{")?":":"=";seperator=(open==="{")?",":" ";function process_pair(){if(typeof pair.start==="number"&&typeof pair.middle==="number"&&typeof pair.end==="number"){var key=line.substr(pair.start,pair.middle-pair.start).trim(),value=line.substr(pair.middle+1,pair.end-pair.middle-1).trim();attributes[key]=value}pair={start:null,middle:null,end:null}}for(i=1;count>0;i+=1){if(i>l){throw"Malformed attribute block"}c=line.charAt(i);if(skip){skip=false}else{if(quote){if(c==="\\"){skip=true}if(c===quote){quote=false}}else{if(c==='"'||c==="'"){quote=c}if(count===1){if(c===joiner){pair.middle=i}if(c===seperator||c===close){pair.end=i;process_pair();if(c===seperator){pair.start=i+1}}}if(c===open||c==="("){count+=1}if(c===close||(count>1&&c===")")){count-=1}}}}attributes._content=line.substr(i,line.length);return attributes}function parse_interpol(value){var items=[],pos=0,next=0,match;while(true){next=value.substr(pos).search(embedder);if(next<0){if(pos<value.length){items.push(JSON.stringify(value.substr(pos)))}break}items.push(JSON.stringify(value.substr(pos,next)));pos+=next;match=value.substr(pos).match(embedder);next=match[0].length;if(next<0){break}if(match[1]==="#"){items.push(escaperName+"("+(match[2]||match[3])+")")}else{items.push(match[2]||match[3])}pos+=next}return items.filter(function(part){return part&&part.length>0}).join(" +\n")}embedder=/([#!])\{([^}]*)\}/;self_close_tags=["meta","img","link","br","hr","input","area","base"];matchers=[{name:"html tags",regexp:/^(\s*)((?:[.#%][a-z_\-][a-z0-9_:\-]*)+)(.*)$/i,process:function(){var line_beginning,tag,classes,ids,attribs,content,whitespaceSpecifier,whitespace={},output;line_beginning=this.matches[2];classes=line_beginning.match(/\.([a-z_\-][a-z0-9_\-]*)/gi);ids=line_beginning.match(/\#([a-z_\-][a-z0-9_\-]*)/gi);tag=line_beginning.match(/\%([a-z_\-][a-z0-9_:\-]*)/gi);tag=tag?tag[0].substr(1,tag[0].length):"div";attribs=this.matches[3];if(attribs){attribs=parse_attribs(attribs);if(attribs._content){var leader0=attribs._content.charAt(0),leader1=attribs._content.charAt(1),leaderLength=0;if(leader0=="<"){leaderLength++;whitespace.inside=true;if(leader1==">"){leaderLength++;whitespace.around=true}}else{if(leader0==">"){leaderLength++;whitespace.around=true;if(leader1=="<"){leaderLength++;whitespace.inside=true}}}attribs._content=attribs._content.substr(leaderLength);this.contents.unshift(attribs._content.trim());delete (attribs._content)}}else{attribs={}}if(classes){classes=classes.map(function(klass){return klass.substr(1,klass.length)}).join(" ");if(attribs["class"]){try{attribs["class"]=JSON.stringify(classes+" "+JSON.parse(attribs["class"]))}catch(e){attribs["class"]=JSON.stringify(classes+" ")+" + "+attribs["class"]}}else{attribs["class"]=JSON.stringify(classes)}}if(ids){ids=ids.map(function(id){return id.substr(1,id.length)}).join(" ");if(attribs.id){attribs.id=JSON.stringify(ids+" ")+attribs.id}else{attribs.id=JSON.stringify(ids)}}attribs=render_attribs(attribs);content=this.render_contents();if(content==='""'){content=""}if(whitespace.inside){if(content.length==0){content='"  "'}else{try{content='" '+JSON.parse(content)+' "'}catch(e){content='" "+\n'+content+'+\n" "'}}}if(forceXML?content.length>0:self_close_tags.indexOf(tag)==-1){output='"<'+tag+attribs+'>"'+(content.length>0?" + \n"+content:"")+' + \n"</'+tag+'>"'}else{output='"<'+tag+attribs+' />"'}if(whitespace.around){output='" '+output.substr(1,output.length-2)+' "'}return output}},{name:"each loop",regexp:/^(\s*)(?::for|:each)\s+(?:([a-z_][a-z_\-]*),\s*)?([a-z_][a-z_\-]*)\s+in\s+(.*)(\s*)$/i,process:function(){var ivar=this.matches[2]||"__key__",vvar=this.matches[3],avar=this.matches[4],rvar="__result__";if(this.matches[5]){this.contents.unshift(this.matches[5])}return"(function () { var "+rvar+" = [], "+ivar+", "+vvar+"; for ("+ivar+" in "+avar+") { if ("+avar+".hasOwnProperty("+ivar+")) { "+vvar+" = "+avar+"["+ivar+"]; "+rvar+".push(\n"+(this.render_contents()||"''")+"\n); } } return "+rvar+'.join(""); }).call(this)'}},{name:"if",regexp:/^(\s*):if\s+(.*)\s*$/i,process:function(){var condition=this.matches[2];return"(function () { if ("+condition+") { return (\n"+(this.render_contents()||"")+'\n);} else { return ""; } }).call(this)'}},{name:"silent-comments",regexp:/^(\s*)-#\s*(.*)\s*$/i,process:function(){return'""'}},{name:"silent-comments",regexp:/^(\s*)\/\s*(.*)\s*$/i,process:function(){this.contents.unshift(this.matches[2]);return'"<!--'+this.contents.join("\\n")+'-->"'}},{name:"rawjs",regexp:/^(\s*)-\s*(.*)\s*$/i,process:function(){this.contents.unshift(this.matches[2]);return'"";'+this.contents.join("\n")+"; _$output = _$output "}},{name:"pre",regexp:/^(\s*):pre(\s+(.*)|$)/i,process:function(){this.contents.unshift(this.matches[2]);return'"<pre>"+\n'+JSON.stringify(this.contents.join("\n"))+'+\n"</pre>"'}},{name:"doctype",regexp:/^()!!!(?:\s*(.*))\s*$/,process:function(){var line="";switch((this.matches[2]||"").toLowerCase()){case"":line='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">';break;case"strict":case"1.0":line='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">';break;case"frameset":line='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd">';break;case"5":line="<!DOCTYPE html>";break;case"1.1":line='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">';break;case"basic":line='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML Basic 1.1//EN" "http://www.w3.org/TR/xhtml-basic/xhtml-basic11.dtd">';break;case"mobile":line='<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.2//EN" "http://www.openmobilealliance.org/tech/DTD/xhtml-mobile12.dtd">';break;case"xml":line="<?xml version='1.0' encoding='utf-8' ?>";break;case"xml iso-8859-1":line="<?xml version='1.0' encoding='iso-8859-1' ?>";break}return JSON.stringify(line+"\n")}},{name:"markdown",regexp:/^(\s*):markdown\s*$/i,process:function(){return parse_interpol(exports.Markdown.encode(this.contents.join("\n")))}},{name:"script",regexp:/^(\s*):(?:java)?script\s*$/,process:function(){return parse_interpol('\n<script type="text/javascript">\n//<![CDATA[\n'+this.contents.join("\n")+"\n//]]>\n<\/script>\n")}},{name:"css",regexp:/^(\s*):css\s*$/,process:function(){return JSON.stringify('<style type="text/css">\n'+this.contents.join("\n")+"\n</style>")}}];function compile(lines){var block=false,output=[];if(typeof lines==="string"){lines=lines.trim().replace(/\n\r|\r/g,"\n").split("\n")}lines.forEach(function(line){var match,found=false;if(block){match=block.check_indent.exec(line);if(match){block.contents.push(match[1]||"");return}else{output.push(block.process());block=false}}matchers.forEach(function(matcher){if(!found){match=matcher.regexp.exec(line);if(match){block={contents:[],indent_level:(match[1]),matches:match,check_indent:new RegExp("^(?:\\s*|"+match[1]+"  (.*))$"),process:matcher.process,render_contents:function(){return compile(this.contents)}};found=true}}});if(!found){output.push(function(){if(line[0]==="\\"){return parse_interpol(line.substr(1,line.length))}function escapedLine(){try{return escaperName+"("+JSON.stringify(JSON.parse(line))+")"}catch(e2){return escaperName+"("+line+")"}}function unescapedLine(){try{return parse_interpol(JSON.parse(line))}catch(e){return line}}if((line.substr(0,2)==="&=")){line=line.substr(2,line.length).trim();return escapedLine()}if((line.substr(0,2)==="!=")){line=line.substr(2,line.length).trim();return unescapedLine()}if((line[0]==="=")){line=line.substr(1,line.length).trim();if(escapeHtmlByDefault){return escapedLine()}else{return unescapedLine()}}return parse_interpol(line)}())}});if(block){output.push(block.process())}var txt=output.filter(function(part){return part&&part.length>0}).join(" +\n");if(txt.length==0){txt='""'}return txt}function optimize(js){var new_js=[],buffer=[],part,end;function flush(){if(buffer.length>0){new_js.push(JSON.stringify(buffer.join(""))+end);buffer=[]}}js.replace(/\n\r|\r/g,"\n").split("\n").forEach(function(line){part=line.match(/^(\".*\")(\s*\+\s*)?$/);if(!part){flush();new_js.push(line);return}end=part[2]||"";part=part[1];try{buffer.push(JSON.parse(part))}catch(e){flush();new_js.push(line)}});flush();return new_js.join("\n")}function render(text,options){options=options||{};text=text||"";var js=compile(text,options);if(options.optimize){js=Haml.optimize(js)}return execute(js,options.context||Haml,options.locals)}function execute(js,self,locals){return(function(){with(locals||{}){try{var _$output;eval("_$output ="+js);return _$output}catch(e){return"\n<pre class='error'>"+html_escape(e.stack)+"</pre>\n"}}}).call(self)}Haml=function Haml(haml,config){if(typeof(config)!="object"){forceXML=config;config={}}var escaper;if(config.customEscape){escaper="";escaperName=config.customEscape}else{escaper=html_escape.toString()+"\n";escaperName="html_escape"}escapeHtmlByDefault=(config.escapeHtmlByDefault||config.escapeHTML||config.escape_html);var js=optimize(compile(haml));var str="with(locals || {}) {\n  try {\n   var _$output="+js+";\n return _$output;  } catch (e) {\n    return \"\\n<pre class='error'>\" + "+escaperName+'(e.stack) + "</pre>\\n";\n  }\n}';try{var f=new Function("locals",escaper+str);return f}catch(e){if(typeof(console)!=="undefined"){console.error(str)}throw e}};Haml.compile=compile;Haml.optimize=optimize;Haml.render=render;Haml.execute=execute;Haml.html_escape=html_escape}());if(typeof module!=="undefined"){module.exports=Haml};