.container-fluid
  #container.row-fluid
    .span2
      .well.sidebar-nav
        %h3 菜单
        %url.nav.nav-list
          %li
            %a{:href => template_projects_path()}
              %i.icon-home
              项目列表
          %li
            %a{:href => "#/reports"}
              %i.icon-file
              通用报告管理
          %li
            %a{:href => "#/segments"}
              %i.icon-user
              通用用户群管理
          %li
            %a{:href => "#/dashboard"}
              %i.icon-user
              通用数据面板管理
          %li
            %a{:href => "#/broadcasting"}
              %i.icon-volume-up
              公告栏管理
    .span10
      #main-container
        %h3 项目列表
        %hr
        %table.table.table-striped.table-bordered.table-condensed
          %thead
            %th 项目
            %th 标示符
          %tbody
            - @projects.each do |project|
              %tr
                %td= link_to project.name, project_path(project)
                %td= project.identifier
        = will_paginate @projects

:javascript
  Instances.Collections = {
    user_attributes: new Analytics.Collections.UserAttributes([]),
    segments: new Analytics.Collections.Segments(#{Segment.template.map(&:js_attributes).to_json}),
    expressions: new Analytics.Collections.Expressions([]),
    report_categories: new Analytics.Collections.ReportCategories(#{ReportCategory.template.map(&:js_attributes).to_json}),
    reports: new Analytics.Collections.Reports(#{Report.template.map(&:js_attributes).to_json}),
    report_tabs: new Analytics.Collections.ReportTabs([]),
    widgets: new Analytics.Collections.Widgets(#{Widget.template.map(&:js_attributes).to_json}),
    metrics: new Analytics.Collections.Metrics(#{Metric.template.where(:combine_id => nil).map(&:js_attributes).to_json}),
    broadcastings: new Analytics.Collections.Broadcastings(#{Broadcasting.all.map(&:js_attributes).to_json})
  };
  Instances.Collections.reports.init_report_tabs();
  Instances.Collections.segments.init_expressions();
  Instances.Routers = {
    report_categories_router: new Analytics.Routers.ReportCategoriesRouter(),
    reports_router: new Analytics.Routers.ReportsRouter(),
    segments_router: new Analytics.Routers.SegmentsRouter(),
    widgets_router: new Analytics.Routers.WidgetsRouter(),
    broadcasting_router: new Analytics.Routers.BroadcastingRouter()
  };
  Backbone.history.start();